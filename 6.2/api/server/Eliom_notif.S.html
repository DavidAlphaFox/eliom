<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Module type Eliom_notif.​S </title><meta charset="utf8"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="/js/client.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script></head><body><div class="project-eliom"><div class="project-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><ul><li><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-current"><a href="/eliom/6.2/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/2.8.4/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/ocsigenserver/2.8/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li><a href="/lwt/3.1.0/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-toolkit/1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li><a href="/ocsigen-start/1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li><a href="/projects" class="ocsimore_phrasing_link">Other projects</a></li></ul></div><div class="client-server-switch-wrapper"><div class="client-server-switch"><span class="server source">This is server API</span> API (go to <a class="client target" href="/eliom/6.2/api/client/Eliom_notif.S">client</a>)</div></div><button id="reason">Switch to </button><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><h1>Module type <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S">Eliom_notif.​S</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module type</span> <span class="ocsforge_color_uid">S</span> <span class="ocsforge_color_delimiter">=</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>Signature of the functors <span class="odocwiki_inlinecode">Eliom_notif.Make</span> and <span class="odocwiki_inlinecode">Eliom_notif.Make_Simple</span>.
</p><p><span class="odocwiki_inlinecode">S</span> has two types of notifications (<span class="odocwiki_inlinecode">server_notif</span> and <span class="odocwiki_inlinecode">client_notif</span>)
because we might need to serialise and deserialise the notification twice
(in case of a multi-server set-up). Once for broadcasting it to other
servers and once for transferring it to the client (after possibly
transforming the message using information which is only locally available
(see <span class="odocwiki_inlinecode">prepare</span> below).
</p><hr/><pre class="ocsforge_color odocwiki_code" id="TYPEidentity"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">identity</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">identity</span> is the type of values used to differentiate one listener
from another. Typically it will be a user, but it could also for
instance be a chat window.</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEkey"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">key</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">key</span> is the type of values designating a given resource.</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEserver_notif"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">server_notif</span></pre><div class="odocwiki_info"><p>server notification type; Can be different from <span class="odocwiki_inlinecode">client_notif</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEclient_notif"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_name">client_notif</span></pre><div class="odocwiki_info"><p>client notification type; Can be different from <span class="odocwiki_inlinecode">server_notif</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALinit"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">init</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Initialise the notification module for the current client. This function
needs to be called before using most other functions of this module. It
isn't called implicitely during module instantiation because it relies on
identity data which might not be available yet.</p></div><pre class="ocsforge_color odocwiki_code" id="VALdeinit"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">deinit</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Deinitialise/deactivate the notification module for the current client.</p></div><pre class="ocsforge_color odocwiki_code" id="VALlisten"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">listen</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEkey">key</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Make client process listen on data whose index is <span class="odocwiki_inlinecode">key</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALunlisten"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">unlisten</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEkey">key</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Stop listening on data <span class="odocwiki_inlinecode">key</span></p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S.Ext">Ext</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S.Ext">..</a></span><span class="ocsforge_color_keyword">end</span></pre><pre class="ocsforge_color odocwiki_code" id="VALnotify"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">notify</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">?notfor:</span>[ `Id of <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEidentity">identity</a></span> | `Me ] <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEkey">key</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEserver_notif">server_notif</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Call <span class="odocwiki_inlinecode">notify key n</span> to send a notification <span class="odocwiki_inlinecode">n</span> to all clients currently
listening on data referenced by <span class="odocwiki_inlinecode">key</span>.
</p><p>If <span class="odocwiki_inlinecode">~notfor</span> is <span class="odocwiki_inlinecode">`Me</span>, notification will not be sent to the tab currently
doing the request (the one which caused the notification to happen).
Note that if <span class="odocwiki_inlinecode">notify</span> is called with <span class="odocwiki_inlinecode">~notfor:`Me</span> outside of a request it
will fail. If it is <span class="odocwiki_inlinecode">`Id id</span> it won't be sent to the destination defined
by <span class="odocwiki_inlinecode">id</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="VALclient_ev"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">client_ev</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  unit <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_delimiter">(</span><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEkey">key</a></span> * <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_notif.S#TYPEclient_notif">client_notif</a></span><span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_react.Down#TYPEt">Eliom_react.Down.t</a></span></span></pre><div class="odocwiki_info"><p>Returns the client react event. Map a function on this event to react
to notifications from the server.
For example:
</p><p>let%client handle_notification some_stuff ev =
...
</p><p>let%server something some_stuff =
ignore
<span class="odocwiki_inlinecode">%client
(ignore (React.E.map
(handle_notification ~%some_stuff)
~%(Notif_module.client_ev ())
) : unit)</span></p></div><pre class="ocsforge_color odocwiki_code" id="VALclean"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">clean</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p>Call <span class="odocwiki_inlinecode">clean ()</span> to clear the tables from empty data.</p></div></div></body></html>
