<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Module Eliom_cscache </title><meta charset="utf8"/><link rel="stylesheet" href="file:///home/balat/ocsigen/ocsigen.github.io/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="/client.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script></head><body><div class="client-server-switch-wrapper"><div class="client-server-switch"><span class="server source">This is server API</span> API (go to <a class="client target" href="/eliom/6.2/api/client/Eliom_cscache">client</a>)</div></div><button id="reason">Switch to </button><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><h1>Module <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache">Eliom_cscache</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">Eliom_cscache</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache">..</a></span><span class="ocsforge_color_keyword">end</span></pre><p>Client-server cache for Eliom applications, that is used both for
keeping data on client side or keeping values in memory during a
request.
</p><p>When you get a piece of data through Eliom_cscache from client-side,
the request to the server is done only if the data is not already in
the client-side cache.
</p><p>On server side, Eliom_cscache is using a temporary cache
(with &quot;request&quot; scope) to avoid fetching the data several time from the
database during the same request. This server-side cache is
automatically sent to the client to fill the client-side
cache. If you want to avoid too many requests from the
client, prefill the server-side cache with the data the
client program will need.
</p><p>This module hides many subtelties that are useful for
client-server (possibly reactive) applications, like, for example,
handling delays correctly both on client and server sides.
</p><p>In the near future, Eliom_cscache will make it possible to save persistent
data, which is useful for implementing off-line applications.
</p><hr/><pre class="ocsforge_color odocwiki_code" id="TYPEt"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, 'b<span class="ocsforge_color_delimiter">)</span></span> <span class="odocwiki_name">t</span></pre><div class="odocwiki_info"><p>The type of association tables (implemented using Hashtbl)</p></div><pre class="ocsforge_color odocwiki_code" id="VALfind"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">find</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, 'b<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache#TYPEt">t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>'a <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span><span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">find cache get_from_db key</span> returns the value associated to <span class="odocwiki_inlinecode">key</span>
in cache.  If not present, it calls <span class="odocwiki_inlinecode">get_from_db</span> to fetch the
data from the database. <span class="odocwiki_inlinecode">get_from_db</span> must be implemented both
server and client sides.  Several simultaneous call to <span class="odocwiki_inlinecode">find</span> will
result in a single call to <span class="odocwiki_inlinecode">get_from_db</span>. Exceptions are not
cached.</p></div><pre class="ocsforge_color odocwiki_code" id="VALdo_cache"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">do_cache</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, 'b<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache#TYPEt">t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span class="ocsforge_color_delimiter">-&gt;</span> unit</span></pre><div class="odocwiki_info"><p><span class="odocwiki_inlinecode">do_cache cache key value</span> adds the association from <span class="odocwiki_inlinecode">key</span> to
<span class="odocwiki_inlinecode">value</span> in <span class="odocwiki_inlinecode">cache</span>, or replaces it if not already present.  Called
from client side, it affects only client side cache.  Called from
server side, it will have effect both on the server cache (scope:
request) and the client side cache.</p></div><pre class="ocsforge_color odocwiki_code" id="VALlocal_find"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">local_find</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, 'b<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache#TYPEt">t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> 'b <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>Find a piece of data in local cache, without trying to fetch it
from server. Raises <span class="odocwiki_inlinecode">Not_found</span> instead.  If the value is currently
beeing retrieved, it waits for it to be ready before returning.</p></div><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONNot_ready"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">Not_ready</span></pre><pre class="ocsforge_color odocwiki_code" id="VALfind_if_ready"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">find_if_ready</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, 'b<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache#TYPEt">t</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> 'b</span></pre><div class="odocwiki_info"><p>Find a piece of data in local cache, without trying to fetch it
from server. Raises <span class="odocwiki_inlinecode">Not_found</span> instead.  If the value is currently
beeing retrieved, it raises <span class="odocwiki_inlinecode">Not_ready</span>.</p></div><p>Load (or reload) in cache the piece of data from server
</p><pre class="ocsforge_color odocwiki_code" id="VALcreate"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">create</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">unit <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>'a, 'b<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache#TYPEt">t</a></span></span></pre><div class="odocwiki_info"><p>Create a new table. Must be called from server side.</p></div></body></html>
