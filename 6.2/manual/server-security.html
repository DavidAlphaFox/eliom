<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ocsigen</title><meta charset="utf8"/></head><body><h1> Eliom's Reference manual</h1><h2><a href="/eliom/6.2/manual/intro.html" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server-side programming</h2><h3>Services</h3><h4><a href="/eliom/6.2/manual/server-services.html" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/6.2/manual/server-params.html" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/6.2/manual/server-outputs.html" class="ocsimore_phrasing_link">Service handlers</a></h4><h4><a href="/eliom/6.2/manual/server-links.html" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/6.2/manual/server-state.html" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/6.2/manual/server-security.html" class="ocsimore_phrasing_link">Security</a></h3><h2>Client-server programming</h2><h3><a href="/eliom/6.2/manual/clientserver-applications.html" class="ocsimore_phrasing_link">Eliom applications</a></h3><h3><a href="/eliom/6.2/manual/clientserver-html.html" class="ocsimore_phrasing_link">Generating HTML</a></h3><h3><a href="/eliom/6.2/manual/clientserver-communication.html" class="ocsimore_phrasing_link">Communication</a></h3><h3><a href="/eliom/6.2/manual/clientserver-services.html" class="ocsimore_phrasing_link">Client-side services</a></h3><h3><a href="/eliom/6.2/manual/clientserver-react.html" class="ocsimore_phrasing_link">Shared reactive programming</a></h3><h3><a href="/eliom/6.2/manual/clientserver-cache.html" class="ocsimore_phrasing_link">Caching data and off-line applications</a></h3><h3><a href="/eliom/6.2/manual/clientserver-wrapping.html" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h2>Workflows</h2><h3><a href="/eliom/6.2/manual/workflow-distillery.html" class="ocsimore_phrasing_link">Distillery</a></h3><h3><a href="/eliom/6.2/manual/mobile-apps.html" class="ocsimore_phrasing_link">Mobile apps</a></h3><h3><a href="/eliom/6.2/manual/workflow-compilation.html" class="ocsimore_phrasing_link">Compilation</a></h3><h3><a href="/eliom/6.2/manual/workflow-configuration.html" class="ocsimore_phrasing_link">Configuration &amp; running</a></h3><h3><a href="/eliom/6.2/manual/scalability.html" class="ocsimore_phrasing_link">Scalability</a></h3><h2>Syntax</h2><h3><a href="/eliom/6.2/manual/ppx-syntax.html" class="ocsimore_phrasing_link">PPX-based syntax</a></h3><h3><a href="/eliom/6.2/manual/clientserver-language.html" class="ocsimore_phrasing_link">Camlp4-based syntax</a></h3><h3><a href="/eliom/6.2/manual/ppx-migration.html" class="ocsimore_phrasing_link">Migration to PPX</a></h3><h1>Server API</h1><h2><a href="/eliom/6.2/api/server/Eliom_lib.html" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_client.html" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_client_value.html" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_common.html" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_config.html" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_request_info.html" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_reference.html" class="ocsimore_phrasing_link">Eliom_reference</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_state.html" class="ocsimore_phrasing_link">Eliom_state</a></h2><h2>Content and form creation</h2><h3><a href="/eliom/6.2/api/server/Eliom_content.html" class="ocsimore_phrasing_link">Eliom_content</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_content.Html.html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_content.Svg.html" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_content.Xml.html" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_tools.html" class="ocsimore_phrasing_link">Eliom_tools</a></h3><h2>Service creation</h2><h3><a href="/eliom/6.2/api/server/Eliom_service.html" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_parameter.html" class="ocsimore_phrasing_link">Eliom_parameter</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.html" class="ocsimore_phrasing_link">Eliom_registration</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Html.html" class="ocsimore_phrasing_link">Eliom_registration.Html</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Action.html" class="ocsimore_phrasing_link">Eliom_registration.Action</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Ocaml.html" class="ocsimore_phrasing_link">Eliom_registration.Ocaml</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.App.html" class="ocsimore_phrasing_link">Eliom_registration.App</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.File.html" class="ocsimore_phrasing_link">Eliom_registration.File</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Any.html" class="ocsimore_phrasing_link">Eliom_registration.Any</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Redirection.html" class="ocsimore_phrasing_link">Eliom_registration.Redirection</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/6.2/api/server/Eliom_shared.html" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_notif.html" class="ocsimore_phrasing_link">Eliom_notif</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_cscache.html" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_bus.html" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_comet.html" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_react.html" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_types.html">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_exceptions.html">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_values.html">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_modules.html">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_module_types.html">Index of module types</a></span></h3><h1>Client API</h1><h2><a href="/eliom/6.2/api/client/Eliom_lib.html" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href="/eliom/6.2/api/client/Eliom_client.html" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href="/eliom/6.2/api/client/Eliom_client_value.html" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2>Content and form creation</h2><h3><a href="/eliom/6.2/api/client/Eliom_content.Html.html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_content.Svg.html" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_content.Xml.html" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/6.2/api/client/Eliom_service.html" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_shared.html" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_cscache.html" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_bus.html" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_comet.html" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_react.html" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_types.html">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_exceptions.html">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_values.html">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_modules.html">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_module_types.html">Index of module types</a></span></h3><h1>Ppx syntax</h1><h2><a href="/eliom/6.2/api/ppx/Ppx_eliom.html" class="ocsimore_phrasing_link">Ppx_eliom</a></h2><h1>Ocamlbuild plugin</h1><h2><a href="/eliom/6.2/api/ocamlbuild/Ocamlbuild_eliom.html" class="ocsimore_phrasing_link">Ocamlbuild_eliom</a></h2><h2>How to write secure applications with Eliom</h2><p>Eliom and Ocsigen server automatically take charge of a lot of security issues. This unburdens the programmer from having to think about most common security problems. This page details various possible design flaws of Web applications, how Eliom and Ocsigen server (possibly) protects you against a possible exploitation of these flaws, and where you should be careful. <em>Please help us maintaining this page, by sending us any comments.</em> </p><h3> HTTPS</h3><p>If your Web site is using HTTP, all requests and responses may be intercepted.
If you want your Web site to be secure, never send private data through HTTP:
</p><ul><li> Pages containing personal data must be sent only through HTTPS
</li><li> Passwords must be sent to the server only through HTTPS
</li><li> Use secure Eliom references to record user name or user ID once the
user is connected, otherwise the session ID may be send through HTTP.
</li></ul><h3> The application only does client-side verification</h3><p>This is probably the biggest (and most dangerous) possible mistake. As the user has an entire control over the data sent to the server, <strong>never</strong> assume that the data sent by the client has been verified (even if some validation happens in Js_of_ocaml).
Instead, reimplement all verification server-side.
</p><ul><li> As a (small) mitigating factor, Eliom automatically checks that the type of the parameters is correct.
</li><li> Suggested approach: use permissions to control if the user is allowed to perform an action. Then,
<ul><li> when creating a form, check if the user has the required permission (if not, you will usually display a message <em>insufficient permissions</em> instead of the form)
</li><li> in the service that answers to the form, perform the exact same check
</li></ul></li></ul><p>However, as we are using safe unmarshaling, incorrect data will never
crash the server.
</p><p>Example: Never trust the (current) user ID sent by the client process.
Always take the userid from the session, through cookies.
</p><h3> Incorrect access controls</h3><p>This typically happens if authentication is badly implemented, or altogether missing in some places.
</p><ul><li> each URL should implement user verification. Never assume that the user
comes from a trusted URL, for example because the URL is secret.
</li><li> use a programmatic, layered model, which encodes the various user rights (for ex: admin/moderators/editors/connected users/anonymous).
Thus a compromised login will not compromise the entire application
</li><li> Do not leak information through erroneous login (such as <em>this login does not exist</em>). Always answer <em>Bad login or password</em>, using always the same string
</li><li> Do not permit too many near-simultaneous login attempts, either for the same login, or from the same IP. You can use the module Lwt_throttle to delay login, if too many connections are started.
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Code_injection" class="ocsimore_phrasing_link">Code injection</a></h3><ul><li> Eliom modules are written in OCaml, which is a compiled language. This prevents all code injection possible with scripting languages.
</li><li> No SQL injection is possible if you use Macaque or PGOCaml, which use PostgreSQL prepared statements.
</li><li> No HTML injection is possible, as unsafe HTML characters are always escaped before being written.
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Directory_traversal" class="ocsimore_phrasing_link">Path traversal</a></h3><ul><li> The module <span><a class="ocsforge_doclink_ocsigenserver" href="/ocsigenserver/2.8/manual/extendconfiguration.html">Extendconfiguration </a></span> can be used to prevent access to files or entire directories, from both Staticmod and Eliom.
</li><li> Even if <span><a class="ocsforge_doclink_ocsigenserver" href="/ocsigenserver/2.8/manual/userconf.html">userconf</a></span> is activated, users can only expose their own files; see the <span class="teletype">localpath</span> option for details.
</li><li> Occurrences of the <span class="teletype">'..'</span> pattern appearing in URLs are automatically removed by the server
</li><li> Ocsigen automatically decode HTML entities in URLs, which protects against attacks based on quoted characters
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Session_fixation" class="ocsimore_phrasing_link">Session fixation</a></h3><ul><li> Ocsigen cookies are cryptographically generated, and cannot be guessed by the attacker. Thus the attacker cannot control, or supply, the cookie of the client.
</li><li> To be completely safe, do not issue tokens to anonymous users, or issue a new token as soon as a login/logout takes place
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Cross-site_scripting" class="ocsimore_phrasing_link">Cross-site scripting (XSS)</a></h3><ul><li> most XSS attacks require code injection, from which you are automatically protected (see above)
</li><li> However, avoid at all costs to put user-supplied text in sensitive tags, including:
<ul><li> <span class="teletype">&lt;script&gt;</span> tags
</li><li> javascripts events such as <span class="teletype">onmouseover</span>
</li><li> inside <span class="teletype">&lt;meta&gt;</span> refresh tags
</li></ul></li><li> if the user can upload files, sanitize very severely html or text files (that can contain javascript). Moreover, IE sometimes disregards the content-type send by the server when it receives an image that is actually html, so you also need to check those files.
</li></ul><h3> <a href="http://en.wikipedia.org/wiki/Cross-site_tracing" class="ocsimore_phrasing_link">Cross site tracing</a></h3><ul><li> Ocsigen server does not implement the trace directive.
</li><li> Furthermore, this attack is no longer really relevant, as current browsers protect against this kind of exploit
</li></ul><h3> Redirection attacks</h3><ul><li> Do not let the user supply the URL to which a page redirects.
</li><li> Using Eliom, you can use non-attached co-services to implement functionalities such as login forms. This way:
<ul><li> you have a login form on each page
</li><li> you write the login code only once
</li><li> the user will not have control of any redirection
</li></ul></li></ul><h3> <a href="http://en.wikipedia.org/wiki/HTTP_header_injection" class="ocsimore_phrasing_link">Header injection</a></h3><ul><li> In general, do not let the user write text inside HTTP headers
</li><li> Likewise, do not let the user write its own value in a Cookie, as it gives access to this header
</li><li> To protect against badly written applications, Ocsigen sanitizes HTTP headers when it prints them: a space is inserted before any CR or LF occurring in the content of a header
</li></ul><h3> On-site request forgery</h3><ul><li> If a user has control of a URL (especially one that is automatically read, such as an <span class="teletype">&lt;img&gt;</span>), remove characters such as <span class="teletype">?, &amp;, =</span>...
</li><li> As a mitigating factor, do not write GET services that actually perform actions. Use only POST, which cannot be invoked from a URL.
</li></ul><h3 id="csrf"> <a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery" class="ocsimore_phrasing_link">Cross-site request forgery (XSRF)</a> <a class="backref" href="#csrf">&#182;</a></h3><ul><li> Eliom provides automatic protection: see the parameter <span class="teletype">csrf_safe</span> of coservices
</li><li> Alternatively, each time you generate a form, add a hidden field containing a unique id. The service that is called by the form must check that the id is valid.
</li></ul><h3> Denial of service</h3><ul><li> Use session groups to prevent a user from creating an unlimited number of sessions or dynamic services. (And do not attribute tokens to anonymous users). Even if you do not use session groups, Eliom limits the number of in memory sessions by sub network. <em>Warning: no limitation of the number of persistent sessions</em>.
</li></ul></body></html>
