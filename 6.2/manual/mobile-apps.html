<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title> Writing multi-platform apps with Eliom (Web and mobile)</title><meta charset="utf8"/></head><body><h1> Eliom's Reference manual</h1><h2><a href="/eliom/6.2/manual/intro.html" class="ocsimore_phrasing_link">Introduction</a></h2><h2>Server-side programming</h2><h3>Services</h3><h4><a href="/eliom/6.2/manual/server-services.html" class="ocsimore_phrasing_link">The different types of services</a></h4><h4><a href="/eliom/6.2/manual/server-params.html" class="ocsimore_phrasing_link">Typing service parameters</a></h4><h4><a href="/eliom/6.2/manual/server-outputs.html" class="ocsimore_phrasing_link">Service handlers</a></h4><h4><a href="/eliom/6.2/manual/server-links.html" class="ocsimore_phrasing_link">Creating links and forms</a></h4><h3><a href="/eliom/6.2/manual/server-state.html" class="ocsimore_phrasing_link">Sessions and server side state</a></h3><h3><a href="/eliom/6.2/manual/server-security.html" class="ocsimore_phrasing_link">Security</a></h3><h2>Client-server programming</h2><h3><a href="/eliom/6.2/manual/clientserver-applications.html" class="ocsimore_phrasing_link">Eliom applications</a></h3><h3><a href="/eliom/6.2/manual/clientserver-html.html" class="ocsimore_phrasing_link">Generating HTML</a></h3><h3><a href="/eliom/6.2/manual/clientserver-communication.html" class="ocsimore_phrasing_link">Communication</a></h3><h3><a href="/eliom/6.2/manual/clientserver-services.html" class="ocsimore_phrasing_link">Client-side services</a></h3><h3><a href="/eliom/6.2/manual/clientserver-react.html" class="ocsimore_phrasing_link">Shared reactive programming</a></h3><h3><a href="/eliom/6.2/manual/clientserver-cache.html" class="ocsimore_phrasing_link">Caching data and off-line applications</a></h3><h3><a href="/eliom/6.2/manual/clientserver-wrapping.html" class="ocsimore_phrasing_link">Custom wrapping</a></h3><h2>Workflows</h2><h3><a href="/eliom/6.2/manual/workflow-distillery.html" class="ocsimore_phrasing_link">Distillery</a></h3><h3><a href="/eliom/6.2/manual/mobile-apps.html" class="ocsimore_phrasing_link">Mobile apps</a></h3><h3><a href="/eliom/6.2/manual/workflow-compilation.html" class="ocsimore_phrasing_link">Compilation</a></h3><h3><a href="/eliom/6.2/manual/workflow-configuration.html" class="ocsimore_phrasing_link">Configuration &amp; running</a></h3><h3><a href="/eliom/6.2/manual/scalability.html" class="ocsimore_phrasing_link">Scalability</a></h3><h2>Syntax</h2><h3><a href="/eliom/6.2/manual/ppx-syntax.html" class="ocsimore_phrasing_link">PPX-based syntax</a></h3><h3><a href="/eliom/6.2/manual/clientserver-language.html" class="ocsimore_phrasing_link">Camlp4-based syntax</a></h3><h3><a href="/eliom/6.2/manual/ppx-migration.html" class="ocsimore_phrasing_link">Migration to PPX</a></h3><h1>Server API</h1><h2><a href="/eliom/6.2/api/server/Eliom_lib.html" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_client.html" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_client_value.html" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_common.html" class="ocsimore_phrasing_link">Eliom_common</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_config.html" class="ocsimore_phrasing_link">Eliom_config</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_request_info.html" class="ocsimore_phrasing_link">Eliom_request_info</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_reference.html" class="ocsimore_phrasing_link">Eliom_reference</a></h2><h2><a href="/eliom/6.2/api/server/Eliom_state.html" class="ocsimore_phrasing_link">Eliom_state</a></h2><h2>Content and form creation</h2><h3><a href="/eliom/6.2/api/server/Eliom_content.html" class="ocsimore_phrasing_link">Eliom_content</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_content.Html.html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_content.Svg.html" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_content.Xml.html" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_tools.html" class="ocsimore_phrasing_link">Eliom_tools</a></h3><h2>Service creation</h2><h3><a href="/eliom/6.2/api/server/Eliom_service.html" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_parameter.html" class="ocsimore_phrasing_link">Eliom_parameter</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.html" class="ocsimore_phrasing_link">Eliom_registration</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Html.html" class="ocsimore_phrasing_link">Eliom_registration.Html</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Action.html" class="ocsimore_phrasing_link">Eliom_registration.Action</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Ocaml.html" class="ocsimore_phrasing_link">Eliom_registration.Ocaml</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.App.html" class="ocsimore_phrasing_link">Eliom_registration.App</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.File.html" class="ocsimore_phrasing_link">Eliom_registration.File</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Any.html" class="ocsimore_phrasing_link">Eliom_registration.Any</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_registration.Redirection.html" class="ocsimore_phrasing_link">Eliom_registration.Redirection</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/6.2/api/server/Eliom_shared.html" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_notif.html" class="ocsimore_phrasing_link">Eliom_notif</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_cscache.html" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_bus.html" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_comet.html" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/6.2/api/server/Eliom_react.html" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_types.html">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_exceptions.html">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_values.html">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_modules.html">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/index_module_types.html">Index of module types</a></span></h3><h1>Client API</h1><h2><a href="/eliom/6.2/api/client/Eliom_lib.html" class="ocsimore_phrasing_link">Eliom_lib</a></h2><h2><a href="/eliom/6.2/api/client/Eliom_client.html" class="ocsimore_phrasing_link">Eliom_client</a></h2><h2><a href="/eliom/6.2/api/client/Eliom_client_value.html" class="ocsimore_phrasing_link">Eliom_client_value</a></h2><h2>Content and form creation</h2><h3><a href="/eliom/6.2/api/client/Eliom_content.Html.html" class="ocsimore_phrasing_link">Eliom_content.Html</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_content.Svg.html" class="ocsimore_phrasing_link">Eliom_content.Svg</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_content.Xml.html" class="ocsimore_phrasing_link">Eliom_content.Xml</a></h3><h2>Client/server communication</h2><h3><a href="/eliom/6.2/api/client/Eliom_service.html" class="ocsimore_phrasing_link">Eliom_service</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_shared.html" class="ocsimore_phrasing_link">Eliom_shared</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_cscache.html" class="ocsimore_phrasing_link">Eliom_cscache</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_bus.html" class="ocsimore_phrasing_link">Eliom_bus</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_comet.html" class="ocsimore_phrasing_link">Eliom_comet</a></h3><h3><a href="/eliom/6.2/api/client/Eliom_react.html" class="ocsimore_phrasing_link">Eliom_react</a></h3><h2>Index</h2><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_types.html">Index of types</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_exceptions.html">Index of exceptions</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_values.html">Index of values</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_modules.html">Index of modules</a></span></h3><h3> <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/index_module_types.html">Index of module types</a></span></h3><h1>Ppx syntax</h1><h2><a href="/eliom/6.2/api/ppx/Ppx_eliom.html" class="ocsimore_phrasing_link">Ppx_eliom</a></h2><h1>Ocamlbuild plugin</h1><h2><a href="/eliom/6.2/api/ocamlbuild/Ocamlbuild_eliom.html" class="ocsimore_phrasing_link">Ocamlbuild_eliom</a></h2><h1> Writing multi-platform apps with Eliom (Web and mobile)</h1><p>Starting with Eliom 6.0, you can write HTML5 mobile apps with Eliom.
It is also possible to have one single code base for your Web and mobile
apps (Android, iOS, Windows ...).
</p><p>The best way to start with this feature is to install
<span><a class="ocsforge_doclink_ocsigen-start" href="/ocsigen-start/1.0/manual/intro.html">Ocsigen Start</a></span>.
It contains all the instructions and a template with code samples
that you can adapt to your needs.
</p><p>Here are the main principle for writing multi-platform apps with Eliom:
</p><ul><li> Use responsive Web design to make your app work with any screen size.
</li><li> Register all your services in shared sections. The mobile app will
use the client-side implementation. The Web app will generate the pages
server-side during the first request, and by default, subsequent pages will
be generated client-side. For more info, see the
<span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/manual/clientserver-services.html">client-side services chapter </a></span>
of this manual.
</li><li> Be careful with the order of evaluation, which is different when pages
are generated client-side. Client sections sent by the server will be executed
when the page is ready and already diplayed. But if the page is generated
client-side, client sections will be executed straight-away. You may sometimes
want to delay their execution until the element is inserted in the page
(try <span><a class="ocsforge_doclink_ocsigen-toolkit" href="/ocsigen-toolkit/1.0/api/client/Ot_nodeready.html#VALnodeready">Ot_nodeready.​nodeready</a></span>).
</li><li> Use Apache Cordova or Phonegap to access the mobile device APIs.
</li><li> The main difference between the Web and mobile version is that the mobile
app starts client-side, whereas the Web app is sent by the server. This means
that the server won't be able to send global injections (<span class="teletype">~%v</span> where
<span class="teletype">v</span> is a global server-side value) to the client. To solve this problem,
<span><a class="ocsforge_doclink_ocsigen-start" href="/ocsigen-start/1.0/manual/intro.html">Ocsigen Start</a></span> provides a module
<span class="teletype">Eliom_loader</span> which will get the global data from the server when
starting the app.
</li><li> Define JavaScript variables <span class="teletype">__eliom_server</span> and
<span class="teletype">__eliom_app_name</span> in the <span class="teletype">index.html</span>
of your mobile app, to set the main server and the name of the app.
See <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/Eliom_client.html#VALinit_client_app">Eliom_client.​init_client_app</a></span>
and the default <span class="teletype">eliom.html</span> file generated by
<span><a class="ocsforge_doclink_ocsigen-start" href="/ocsigen-start/1.0/manual/intro.html">Ocsigen Start</a></span>.
</li><li> Use function <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/client/Eliom_client.html#VALis_client_app">Eliom_client.​is_client_app</a></span> to test whether
you are running a mobile app (an app that was started client-side).
<span><a class="ocsforge_doclink_ocsigen-start" href="/ocsigen-start/1.0/manual/intro.html">Ocsigen Start</a></span> also has a class
<span class="teletype">os-client-app</span> on the <span class="teletype">html</span> tag.
</li><li> The JavaScript file generated by Js_of_ocaml will be included in your
mobile app. But it must match exactly the version of the app that is
running on the server. To ensure that, we recommend:
<ul><li> To do an automatic update of the client-side app when the server is
updated (for example with Cordova Hot-code-push, as in
<span><a class="ocsforge_doclink_ocsigen-start" href="/ocsigen-start/1.0/manual/intro.html">Ocsigen Start</a></span>)
</li><li> And possibly to keep several versions of your server app, if you can,
with a load balancer to reach the server that corresponds to the client-side
version.
</li></ul></li><li> By default, all URLs generated by the client app are absolute.
Use absolute:false for the URLs of all the local assets (css, js...)
</li></ul><p>Some caveats:
</p><ul><li> iOS does not handle cookies properly with HTML5 apps. Eliom implements
a workaround, that you can activate by setting the JavaScript variable
<span class="teletype">__eliom_use_cookie_substitutes</span> to <span class="teletype">true</span> in the main HTML
page of your iOS app (see the file eliom.html generated by Ocsigen Start).
</li><li> iOS support of HTML5 Web technologies is lagging behind other platforms
and Apple does ot allow the use of another Web view. This may cause some
troubles on iOS (slowness, display problems ...)
</li></ul><p>Suggestions:
</p><ul><li> Crosswalk can help you to have a modern Web view on old Android platforms.
On iOS, use WkWebview.
</li><li> Use <span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/api/server/Eliom_cscache.html">Eliom_cscache</a></span> to cache the values in your app.
</li><li> Set JavaScript variable <span class="teletype">__eliom_debug_mode</span> to <span class="teletype">true</span> in your HTML
file to set debug mode on client side. It corresponds to the option
<span class="teletype">&lt;debugmode/&gt;</span> in Ocsigen Server's configuration file (server-side).
</li></ul></body></html>
