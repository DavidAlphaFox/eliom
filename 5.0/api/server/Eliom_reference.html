<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Module Eliom_reference </title><meta charset="utf8"/><link rel="stylesheet" href="/css/style.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/themes/prism.min.css"/><script src="/js/client.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-ocaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-clike.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-reason.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.9.0/components/prism-javascript.min.js"></script></head><body><div class="project-page project-eliom"><div class="page-header"><p class="logo-ocsigen"><a href="/" class="ocsimore_phrasing_link"><img src="/img/ocsigen-white.svg" alt="Ocsigen"/></a>
</p><ul><li><a href="/" class="ocsimore_phrasing_link">Home</a>
</li><li class="mainmenu-current"><a href="/eliom/6.2/manual/intro" class="ocsimore_phrasing_link">Eliom</a>
</li><li><a href="/js_of_ocaml/2.8.4/manual/overview" class="ocsimore_phrasing_link">Js_of_ocaml</a>
</li><li><a href="/ocsigenserver/2.8/manual/quickstart" class="ocsimore_phrasing_link">Server</a>
</li><li><a href="/lwt/3.1.0/manual/manual" class="ocsimore_phrasing_link">Lwt</a>
</li><li><a href="/tyxml/4.1.0/manual/intro" class="ocsimore_phrasing_link">Tyxml</a>
</li><li><a href="/ocsigen-toolkit/1.0/manual/intro" class="ocsimore_phrasing_link">Toolkit</a>
</li><li><a href="/ocsigen-start/1.0/manual/intro" class="ocsimore_phrasing_link">Start</a>
</li><li><a href="/projects" class="ocsimore_phrasing_link">Other projects</a></li></ul></div><div class="version-selector"><p>Version
</p><div class="version-selector-versions"><p><span><a class="ocsforge_doclink_eliom" href="/eliom/6.2/manual/intro">6.2</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/6.1/manual/intro">6.1</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/6.0/manual/intro">6.0</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/manual/intro">5.0</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/4.2/manual/intro">4.2</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/4.1/manual/intro">4.1</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/4.0/manual/intro">4.0</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/3.0/manual/intro">3.0</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/2.2.2/manual/intro">2.2.2</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/2.1.1/manual/intro">2.1.1</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/2.0.2/manual/intro">2.0.2</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/2.0.1/manual/intro">2.0.1</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/2.0/manual/intro">2.0</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/1.3.4/manual/intro">1.3.4</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/1.2.2/manual/intro">1.2.2</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/1.1.0/manual/intro">1.1.0</a></span>
<span><a class="ocsforge_doclink_eliom" href="/eliom/dev/manual/intro">dev</a></span></p></div></div><div class="client-server-switch-wrapper"><div class="client-server-switch"><span class="server source">This is server API</span> API (go to <a class="client target" href="/eliom/5.0/api/client/Eliom_reference">client</a>)</div></div><button id="reason">Switch to </button><form id="search"><input name="q" id="q" placeholder="search ..."/><button>Search</button></form><h1>Module <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference">Eliom_reference</a></span> </h1><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span class="ocsforge_color_uid"><span class="ocsforge_color_uid">Eliom_reference</span></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference">..</a></span><span class="ocsforge_color_keyword">end</span></pre><h2 id="2_ServersidestatedataakaEliomreferences">Server side state data, a.k.a Eliom references <a class="backref" href="#2_ServersidestatedataakaEliomreferences">&#182;</a></h2><hr/><p><strong>Please read the
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/manual/server-state">Eliom manual </a></span>
before this page to learn how server side state works. </strong>
</p><pre class="ocsforge_color odocwiki_code" id="TYPEeref'"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, +'storage<span class="ocsforge_color_delimiter">)</span></span> <span class="odocwiki_name">eref'</span></pre><div class="odocwiki_info"><p>Eliom references come in two flavors: they may be stored persistently or
the may be volatile.  The module <span class="odocwiki_inlinecode">Volatile</span> allows creation of
references which can be, get, set, modify, and unset volatile references
through <em>non-Lwt</em> functions.</p></div><pre class="ocsforge_color odocwiki_code" id="TYPEeref"><span class="ocsforge_color_keyword">type</span> <span class="odocwiki_type">'a</span> <span class="odocwiki_name">eref</span> <span class="ocsforge_color_delimiter">=</span> <span class="odocwiki_type"><span class="ocsforge_color_delimiter">(</span>'a, [ `Persistent | `Volatile ]<span class="ocsforge_color_delimiter">)</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref'">eref'</a></span></span></pre><div class="odocwiki_info"><p>The type of Eliom references whose content is of type <span class="odocwiki_inlinecode">'a</span>.</p></div><pre class="ocsforge_color odocwiki_code" id="EXCEPTIONEref_not_initialized"><span class="ocsforge_color_keyword">exception</span> <span class="odocwiki_name">Eref_not_initialized</span></pre><div class="odocwiki_info"><p>Exception raised when trying to access an eref
that has not been initaliazed, when we don't want to initialize it.</p></div><pre class="ocsforge_color odocwiki_code" id="VALeref"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">eref</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">scope:</span>[&lt; <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#TYPEall_scope">Eliom_common.all_scope</a></span> ] <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?secure:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_label">?persistent:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref">eref</a></span></span></pre><div class="odocwiki_info"><p>The function <span class="odocwiki_inlinecode">eref ~scope value</span> creates an Eliom reference for
the given <span class="odocwiki_inlinecode">scope</span> and initialize it with <span class="odocwiki_inlinecode">value</span>. See the Eliom
manual for more information about <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/manual/server-state">scopes</a></span>.
</p><p>Use the optional parameter <span class="odocwiki_inlinecode">?persistent</span> if you want the data to
survive after relaunching the server. You must give an unique name
to the table in which it will be stored on the hard disk (using
Ocsipersist).  Be very careful to use unique names, and to change
the name if you change the type of the data, otherwise the server
may crash (unsafe unmarshaling). This parameter has no effect for
scope <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALrequest_scope">Eliom_common.​request_scope</a></span>.
</p><p>Use the optional parameter <span class="odocwiki_inlinecode">~secure:true</span> if you want the data to
be available only using HTTPS. This parameter has no effect for
scopes <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALglobal_scope">Eliom_common.​global_scope</a></span>, <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALsite_scope">Eliom_common.​site_scope</a></span>, and
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALrequest_scope">Eliom_common.​request_scope</a></span>. The default is <span class="odocwiki_inlinecode">false</span>, but this default
can be changed in configuration file (<span class="odocwiki_inlinecode">&lt;securecookies value=&quot;true&quot;/&gt;</span>).
<em>Warning: Eliom references of scope <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALglobal_scope">Eliom_common.​global_scope</a></span>,
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALsite_scope">Eliom_common.​site_scope</a></span> or
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALrequest_scope">Eliom_common.​request_scope</a></span> may be created at any time ; but for other
scopes, they must be created when the site information is
available to Eliom, that is, either during the initialization
phase of the server (while reading the configuration file) or
during a request. Otherwise, it will raise the exception
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#EXCEPTIONEliom_site_information_not_available">Eliom_common.​Eliom_site_information_not_available</a></span>. If you are
using static linking, you must delay the call to this function
until the configuration file is read, using
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_service#VALregister_eliom_module">Eliom_service.​register_eliom_module</a></span>. Otherwise you will also
get this exception.</em></p></div><pre class="ocsforge_color odocwiki_code" id="VALeref_from_fun"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">eref_from_fun</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type"><br/>  <span class="ocsforge_color_label">scope:</span>[&lt; <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#TYPEall_scope">Eliom_common.all_scope</a></span> ] <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?secure:</span>bool <span class="ocsforge_color_delimiter">-&gt;</span><br/>  <span class="ocsforge_color_label">?persistent:</span>string <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>unit <span class="ocsforge_color_delimiter">-&gt;</span> 'a<span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref">eref</a></span></span></pre><div class="odocwiki_info"><p>The function <span class="odocwiki_inlinecode">eref_from_fun</span> works like the above <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#VALeref">Eliom_reference.​eref</a></span>,
but instead of providing a value for the initial content, a function <span class="odocwiki_inlinecode">f</span> for
<em>creating the initial content</em> is provided (cf. also <span class="odocwiki_inlinecode">Lazy.from_fun</span>).
</p><p>In each scope, the function <span class="odocwiki_inlinecode">f</span> is called for creating the value of the
reference the first time the reference is read (by <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#VALget">Eliom_reference.​get</a></span>),
if the value has not been set explicitly before (by <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#VALset">Eliom_reference.​set</a></span>);
or if the reference was reset (by <span class="odocwiki_inlinecode">Eliom_reference.reset</span>) before.</p></div><pre class="ocsforge_color odocwiki_code" id="VALget"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">get</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref">eref</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>The function <span class="odocwiki_inlinecode">get eref</span> returns the current value of the Eliom
reference <span class="odocwiki_inlinecode">eref</span>.
</p><p><em>Warning: this function cannot be used outside of a service
handler when <span class="odocwiki_inlinecode">eref</span> has been created with a scope different of
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALglobal_scope">Eliom_common.​global_scope</a></span>; it can neither be used outside of an
Eliom module when <span class="odocwiki_inlinecode">eref</span> has been created with scope
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALsite_scope">Eliom_common.​site_scope</a></span></em></p></div><pre class="ocsforge_color odocwiki_code" id="VALset"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">set</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref">eref</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> 'a <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>The function <span class="odocwiki_inlinecode">set eref v</span> set <span class="odocwiki_inlinecode">v</span> as current value of the Eliom
reference <span class="odocwiki_inlinecode">eref</span>.
</p><p><em>Warning: this function could not be used outside af a service
handler when <span class="odocwiki_inlinecode">eref</span> has been created with a scope different of
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALglobal_scope">Eliom_common.​global_scope</a></span>; it can neither be used outside of an
Eliom module when <span class="odocwiki_inlinecode">eref</span> has been created with scope
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALsite_scope">Eliom_common.​site_scope</a></span></em></p></div><pre class="ocsforge_color odocwiki_code" id="VALmodify"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">modify</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref">eref</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> <span class="ocsforge_color_delimiter">(</span>'a <span class="ocsforge_color_delimiter">-&gt;</span> 'a<span class="ocsforge_color_delimiter">)</span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>The function <span class="odocwiki_inlinecode">modify eref f</span> modifies the content of the Eliom
reference <span class="odocwiki_inlinecode">eref</span> by applying the function <span class="odocwiki_inlinecode">f</span> on it.
</p><p><em>Warning: this function could not be used outside af a service
handler when <span class="odocwiki_inlinecode">eref</span> has been created with a scope different of
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALglobal_scope">Eliom_common.​global_scope</a></span>; it can neither be used outside of an
Eliom module when <span class="odocwiki_inlinecode">eref</span> has been created with scope
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALsite_scope">Eliom_common.​site_scope</a></span></em></p></div><pre class="ocsforge_color odocwiki_code" id="VALunset"><span class="ocsforge_color_keyword">val</span> <span class="odocwiki_name">unset</span> <span class="ocsforge_color_delimiter">:</span> <span class="odocwiki_type">'a <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference#TYPEeref">eref</a></span> <span class="ocsforge_color_delimiter">-&gt;</span> unit <span class="ocsforge_color_uid">Lwt</span><span class="ocsforge_color_delimiter">.</span><span class="ocsforge_color_lid">t</span></span></pre><div class="odocwiki_info"><p>The function <span class="odocwiki_inlinecode">unset eref</span> reset the content of the Eliom reference
<span class="odocwiki_inlinecode">eref</span> to its initial value.
</p><p><em>Warning: this function could not be used outside af a service
handler when <span class="odocwiki_inlinecode">eref</span> has been created with a scope different of
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALglobal_scope">Eliom_common.​global_scope</a></span>; it can neither be used outside of an
Eliom module when <span class="odocwiki_inlinecode">eref</span> has been created with scope
<span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_common#VALsite_scope">Eliom_common.​site_scope</a></span></em></p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference.Volatile">Volatile</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference.Volatile">..</a></span><span class="ocsforge_color_keyword">end</span></pre><div class="odocwiki_info"><p>Same functions as in <span class="odocwiki_inlinecode">Eliom_reference</span> but a non-Lwt interface
for non-persistent Eliom references.</p></div><pre class="ocsforge_color odocwiki_code"><span class="ocsforge_color_keyword">module</span> <span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference.Ext">Ext</a></span> <span class="ocsforge_color_delimiter">:</span> <span class="ocsforge_color_keyword">sig</span><span><a class="ocsforge_doclink_eliom" href="/eliom/5.0/api/server/Eliom_reference.Ext">..</a></span><span class="ocsforge_color_keyword">end</span></pre><div class="odocwiki_info"><p>This module allows access to references for other groups,
sessions, or client processes.</p></div></div></body></html>
